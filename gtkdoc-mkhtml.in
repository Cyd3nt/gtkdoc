#!/bin/sh
#

usage="\
Usage: gtkdoc-mkhtml MODULE DRIVER_FILE"

if test "x$1" = "x--version"; then
      echo "@VERSION@"
      exit 0
fi

if test $# -ne 2; then
      echo "${usage}" 1>&2
      exit 1
fi

module=$1
document=$2

prefix=@prefix@
gtkdocdir=@datadir@/gtk-doc

declaration=$gtkdocdir/gtk-doc.dcl

if head -1 $document | grep -q "<?xml"; then
  is_xml=true
else
  is_xml=false
fi

# Delete the old index.sgml file, if it exists.
if test -f index.sgml; then
      rm -f index.sgml
fi

if $is_xml; then
  @XSLTPROC@ --xinclude \
      --stringparam gtkdoc.bookname $module \
      --stringparam gtkdoc.version "@VERSION@" \
      $gtkdocdir/gtk-doc.xsl $document
  cp -f $gtkdocdir/*.png .
else
  @JADE@ -t sgml -w no-idref -d $gtkdocdir/gtk-doc.dsl \
      -V "gtkdoc-bookname=$module" -V "gtkdoc-version=@VERSION@" \
      $gtkdocdir/gtk-doc.dcl $document
fi

echo "timestamp" > ../html.stamp

